<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An Bùi - Trang Chủ</title>
    <link rel="stylesheet" href="styles.css">

    <!-- Mã xác minh AdSense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9732053587082441"
     crossorigin="anonymous"></script>

    <!-- Google Sign-In -->
    <meta name="google-signin-client_id" content="120451681302-7poh20dcpmhh6af5pu2cbs1ts8bj3189.apps.googleusercontent.com">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <header>
        <div class="logo">
            <h1>🌐 An Bùi</h1>
            <p>Chia sẻ kiến thức & Công nghệ</p>
        </div>
        <nav>
            <a href="index.html">🏠 Trang chủ</a>
            <a href="about.html">ℹ️ Giới thiệu</a>
            <a href="privacy.html">🔒 Chính sách</a>
            <a href="contact.html">📩 Liên hệ</a>
        </nav>
    </header>

    <section class="banner">
        <h2>Chào mừng bạn đến với Website!</h2>
        <p>Cập nhật tin tức, thủ thuật, và hướng dẫn lập trình.</p>
    </section>

    <!-- Nút đăng nhập Google -->
    <div id="login-section" style="text-align:center; margin: 20px;">
        <div id="g_id_onload"
            data-client_id="120451681302-7poh20dcpmhh6af5pu2cbs1ts8bj3189.apps.googleusercontent.com"
            data-context="signin"
            data-ux_mode="popup"
            data-callback="handleCredentialResponse"
            data-auto_prompt="false">
        </div>

        <div class="g_id_signin"
            data-type="standard"
            data-shape="rectangular"
            data-theme="outline"
            data-text="signin_with"
            data-size="large"
            data-logo_alignment="left">
        </div>
    </div>

    <!-- Hiển thị thông tin người dùng -->
    <div id="user-info" style="display:none; text-align:center; margin:20px;">
        <img id="user-pic" src="" alt="User Picture" style="width:80px; border-radius:50%;"><br>
        <strong id="user-name"></strong><br>
        <small id="user-email"></small><br>
        <button onclick="logout()" style="margin-top:10px;">Đăng xuất</button>
    </div>

    <main>
        <article class="post">
            <h3>📌 Bài viết nổi bật</h3>
            <p>Đây là đoạn giới thiệu bài viết nổi bật của trang...</p>
        </article>

        <article class="post">
            <h3>💡 Mẹo lập trình cho người mới</h3>
            <p>Bắt đầu với HTML, CSS và JavaScript để xây dựng website của riêng bạn...</p>
        </article>

        <div class="gif-container">
            <h3>🎉 Cảm ơn bạn đã ghé thăm!</h3>
            <img src="https://media.giphy.com/media/26Fxy3Iz1ari8oytO/giphy.gif" alt="Thank you GIF">
        </div>
    </main>

    <footer>
        <p>© 2025 An Bùi. All rights reserved. | <a href="privacy.html">Chính sách bảo mật</a></p>
        <p style="font-style: italic;">“Chia sẻ để cùng phát triển”</p>
    </footer>

    <script>
        function handleCredentialResponse(response) {
            const data = parseJwt(response.credential);

            // Lưu vào LocalStorage
            localStorage.setItem("user", JSON.stringify({
                name: data.name,
                email: data.email,
                picture: data.picture
            }));

            showUserInfo(data);
        }

        function parseJwt(token) {
            var base64Url = token.split('.')[1];
            var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        }

        function showUserInfo(user) {
            document.getElementById("user-name").innerText = user.name;
            document.getElementById("user-email").innerText = user.email;
            document.getElementById("user-pic").src = user.picture;

            document.getElementById("login-section").style.display = "none";
            document.getElementById("user-info").style.display = "block";
        }

        function logout() {
            localStorage.removeItem("user");
            document.getElementById("login-section").style.display = "block";
            document.getElementById("user-info").style.display = "none";
        }

        // Tự động đăng nhập nếu đã lưu
        window.onload = function() {
            const savedUser = localStorage.getItem("user");
            if (savedUser) {
                showUserInfo(JSON.parse(savedUser));
            }
        };
    </script>
</body>
</html>
